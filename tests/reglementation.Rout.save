
R version 4.4.0 (2024-04-24) -- "Puppy Cup"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library (Qair)
Loading required package: timetools
Loading required package: httr
Loading required package: jsonlite
> options(Xair.host='xair.atmo-na.org', Xair.version=2, Xair.port=8443,
+ 		Xair.dsn='N09', Xair.uid='vlad', Xair.pwd='vlad', Xair.drv='oracle')
> 
> # test des calculs de valeurs réglementaires
> #===========================================
> # les calculs tests sont basés sur le réseau de mesure
> # de la qualité de l'air de La Rochelle au cours de l'année 2011
> # (à l'exception du CO qui n'est plus mesuré depuis longtemps)
> 
> stations<- c('VERDUN', 'AYTRE', 'VAUGOI', 'STLOUIS_LR')
> sites	<- 'PLAROC_023'
> debut	<- '2011-01-01'
> fin	<- '2012-01-01'
> xr	<- xrConnect()
> 
> # Les polluants 'continus' (or CO)
> #=================================
> 
> polluants <- c('03', '12', '24', '39', '08', '01')
> for (polluant in polluants)
+ {
+ 	donnees <- xrGetContinuousData (xr, stations=stations, start=debut, end=fin,
+ 					polluants=polluant)
+ 	tmp <- validation.reglementaire (donnees, seuils(polluant=polluant),
+ 					 resultat='comparaison')
+ 	tmp <- lapply (tmp, function(x)
+ 		       if (nrow(x) > 1) lapply (x, sum, na.rm=TRUE) else x)
+ 
+ 	# affichage
+ 	print (xrGetPolluants(xr, search.fields='NOPOL', polluant)$NCON)
+ 	print (tmp)
+ }
Champs disponibles pour la recherche (mesures) : 
IDENTIFIANT, NOM_COURT_MES, NOM_MES, TYPE_MESURE, TYPE_ACQ, compCode, codeP2, D_CREATION, D_ARRET, DERNIER_QH, D_VALIDATION, D_VALIDATION_ENV, D_ADVAL, id_site, NSIT, NSIT_PUBLIC, NOM_COURT_SIT, UNITE, CCHIM, NOPOL

Par défaut : IDENTIFIANT, NOM_COURT_MES


Champs disponibles pour la recherche (stations) : 
IDENTIFIANT, NOM_COURT_SIT, NSIT, ISIT, D_CREATION, D_ARRET, NSIT_PUBLIC, ISIT_LONG, address.commune.labelCommune, NINSEE, LATI, LONGI, ALTI, AXE, CODE_POSTAL, LAMBERTX, LAMBERTY, address.departement.labelDepartement, address.departement.id, DENSITE, NBRE_SOURCES, NB_VEHICULE, RAYON_ACTION, ZONE_IMPLANT, DER_LECT_QH, CLASSE_SITE, SITE_TYPE, TYPE_LIEU_ECHAN, TYPE_VOIE, typologie, environment.locationTypeLabel, environment.samplingPlaceTypeLabel, environment.laneTypeLabel, TYPE_SECTEUR, ZONE_ACTIVITE, sectors.typeSectorLabel, sectors.zoneOfActivityLabel, campaigns

Par défaut : IDENTIFIANT, NOM_COURT_SIT


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
[1] "Dioxyde d'azote"
[[1]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA         0     NA      0          0

[[2]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC           0         0      0      0          0

[[3]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC           0         0      0      0          0

[[4]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC           0         0      0      0          0

[[5]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA     FALSE     NA  FALSE      FALSE

[[6]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA     FALSE     NA  FALSE      FALSE

[[7]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA     FALSE     NA  FALSE       TRUE

[[8]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA     FALSE     NA  FALSE      FALSE

[[9]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA         0     NA      0          0

[[10]]
           start            end NO2_2_AYTRE NO2_AYTRE N2_VA2 N2_VAU NO2_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA         0     NA      0          0

Champs disponibles pour la recherche (mesures) : 
IDENTIFIANT, NOM_COURT_MES, NOM_MES, TYPE_MESURE, TYPE_ACQ, compCode, codeP2, D_CREATION, D_ARRET, DERNIER_QH, D_VALIDATION, D_VALIDATION_ENV, D_ADVAL, id_site, NSIT, NSIT_PUBLIC, NOM_COURT_SIT, UNITE, CCHIM, NOPOL

Par défaut : IDENTIFIANT, NOM_COURT_MES


Champs disponibles pour la recherche (stations) : 
IDENTIFIANT, NOM_COURT_SIT, NSIT, ISIT, D_CREATION, D_ARRET, NSIT_PUBLIC, ISIT_LONG, address.commune.labelCommune, NINSEE, LATI, LONGI, ALTI, AXE, CODE_POSTAL, LAMBERTX, LAMBERTY, address.departement.labelDepartement, address.departement.id, DENSITE, NBRE_SOURCES, NB_VEHICULE, RAYON_ACTION, ZONE_IMPLANT, DER_LECT_QH, CLASSE_SITE, SITE_TYPE, TYPE_LIEU_ECHAN, TYPE_VOIE, typologie, environment.locationTypeLabel, environment.samplingPlaceTypeLabel, environment.laneTypeLabel, TYPE_SECTEUR, ZONE_ACTIVITE, sectors.typeSectorLabel, sectors.zoneOfActivityLabel, campaigns

Par défaut : IDENTIFIANT, NOM_COURT_SIT


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


Simplified splitting algorithm
[1] "Oxydes d azote"
[[1]]
           start            end NOX_2_AYTRE NOX_AYTRE NX_VA2 NX_VAU NOX_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA         0     NA      0          1

[[2]]
           start            end NOX_2_AYTRE NOX_AYTRE NX_VA2 NX_VAU NOX_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA         0     NA      0          1

[[3]]
           start            end NOX_2_AYTRE NOX_AYTRE NX_VA2 NX_VAU NOX_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC          NA         0     NA      0          1

Champs disponibles pour la recherche (mesures) : 
IDENTIFIANT, NOM_COURT_MES, NOM_MES, TYPE_MESURE, TYPE_ACQ, compCode, codeP2, D_CREATION, D_ARRET, DERNIER_QH, D_VALIDATION, D_VALIDATION_ENV, D_ADVAL, id_site, NSIT, NSIT_PUBLIC, NOM_COURT_SIT, UNITE, CCHIM, NOPOL

Par défaut : IDENTIFIANT, NOM_COURT_MES


Champs disponibles pour la recherche (stations) : 
IDENTIFIANT, NOM_COURT_SIT, NSIT, ISIT, D_CREATION, D_ARRET, NSIT_PUBLIC, ISIT_LONG, address.commune.labelCommune, NINSEE, LATI, LONGI, ALTI, AXE, CODE_POSTAL, LAMBERTX, LAMBERTY, address.departement.labelDepartement, address.departement.id, DENSITE, NBRE_SOURCES, NB_VEHICULE, RAYON_ACTION, ZONE_IMPLANT, DER_LECT_QH, CLASSE_SITE, SITE_TYPE, TYPE_LIEU_ECHAN, TYPE_VOIE, typologie, environment.locationTypeLabel, environment.samplingPlaceTypeLabel, environment.laneTypeLabel, TYPE_SECTEUR, ZONE_ACTIVITE, sectors.typeSectorLabel, sectors.zoneOfActivityLabel, campaigns

Par défaut : IDENTIFIANT, NOM_COURT_SIT


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
[1] "PM10"
[[1]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC       0           0       0             0
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1         NA     NA            NA

[[2]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC      10          10      10            10
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1          0      0             0

[[3]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC       1           1       1             1
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1          0      0             0

[[4]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC   FALSE       FALSE   FALSE         FALSE
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1         NA     NA            NA

[[5]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC       0           0       0             0
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1         NA     NA            NA

[[6]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC    TRUE        TRUE    TRUE          TRUE
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1         NA     NA            NA

[[7]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC       1           1       1             1
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1         NA     NA            NA

[[8]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC   FALSE       FALSE   FALSE         FALSE
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1         NA     NA            NA

[[9]]
           start            end X24FVAU PM10_VERDUN X24_VAU PM10_C_VERDUN
1 2011-01-01 UTC 2012-01-01 UTC       0           0       0             0
  PM10_AYTRE PS_VAU PM10NC_VERDUN
1         NA     NA            NA

Champs disponibles pour la recherche (mesures) : 
IDENTIFIANT, NOM_COURT_MES, NOM_MES, TYPE_MESURE, TYPE_ACQ, compCode, codeP2, D_CREATION, D_ARRET, DERNIER_QH, D_VALIDATION, D_VALIDATION_ENV, D_ADVAL, id_site, NSIT, NSIT_PUBLIC, NOM_COURT_SIT, UNITE, CCHIM, NOPOL

Par défaut : IDENTIFIANT, NOM_COURT_MES


Champs disponibles pour la recherche (stations) : 
IDENTIFIANT, NOM_COURT_SIT, NSIT, ISIT, D_CREATION, D_ARRET, NSIT_PUBLIC, ISIT_LONG, address.commune.labelCommune, NINSEE, LATI, LONGI, ALTI, AXE, CODE_POSTAL, LAMBERTX, LAMBERTY, address.departement.labelDepartement, address.departement.id, DENSITE, NBRE_SOURCES, NB_VEHICULE, RAYON_ACTION, ZONE_IMPLANT, DER_LECT_QH, CLASSE_SITE, SITE_TYPE, TYPE_LIEU_ECHAN, TYPE_VOIE, typologie, environment.locationTypeLabel, environment.samplingPlaceTypeLabel, environment.laneTypeLabel, TYPE_SECTEUR, ZONE_ACTIVITE, sectors.typeSectorLabel, sectors.zoneOfActivityLabel, campaigns

Par défaut : IDENTIFIANT, NOM_COURT_SIT


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


Simplified splitting algorithm
[1] "PM2.5"
[[1]]
           start            end PM25_VERDUN BC_PMff_VERD BC_PMwb_VERD HCL_VA
1 2011-01-01 UTC 2012-01-01 UTC           1           NA           NA     NA
  P2_VAU
1     NA

[[2]]
           start            end PM25_VERDUN BC_PMff_VERD BC_PMwb_VERD HCL_VA
1 2011-01-01 UTC 2012-01-01 UTC           0           NA           NA     NA
  P2_VAU
1     NA

[[3]]
           start            end PM25_VERDUN BC_PMff_VERD BC_PMwb_VERD HCL_VA
1 2011-01-01 UTC 2012-01-01 UTC       FALSE           NA           NA     NA
  P2_VAU
1     NA

[[4]]
           start            end PM25_VERDUN BC_PMff_VERD BC_PMwb_VERD HCL_VA
1 2011-01-01 UTC 2012-01-01 UTC           0           NA           NA     NA
  P2_VAU
1     NA

[[5]]
           start            end PM25_VERDUN BC_PMff_VERD BC_PMwb_VERD HCL_VA
1 2011-01-01 UTC 2012-01-01 UTC           0           NA           NA     NA
  P2_VAU
1     NA

Champs disponibles pour la recherche (mesures) : 
IDENTIFIANT, NOM_COURT_MES, NOM_MES, TYPE_MESURE, TYPE_ACQ, compCode, codeP2, D_CREATION, D_ARRET, DERNIER_QH, D_VALIDATION, D_VALIDATION_ENV, D_ADVAL, id_site, NSIT, NSIT_PUBLIC, NOM_COURT_SIT, UNITE, CCHIM, NOPOL

Par défaut : IDENTIFIANT, NOM_COURT_MES


Champs disponibles pour la recherche (stations) : 
IDENTIFIANT, NOM_COURT_SIT, NSIT, ISIT, D_CREATION, D_ARRET, NSIT_PUBLIC, ISIT_LONG, address.commune.labelCommune, NINSEE, LATI, LONGI, ALTI, AXE, CODE_POSTAL, LAMBERTX, LAMBERTY, address.departement.labelDepartement, address.departement.id, DENSITE, NBRE_SOURCES, NB_VEHICULE, RAYON_ACTION, ZONE_IMPLANT, DER_LECT_QH, CLASSE_SITE, SITE_TYPE, TYPE_LIEU_ECHAN, TYPE_VOIE, typologie, environment.locationTypeLabel, environment.samplingPlaceTypeLabel, environment.laneTypeLabel, TYPE_SECTEUR, ZONE_ACTIVITE, sectors.typeSectorLabel, sectors.zoneOfActivityLabel, campaigns

Par défaut : IDENTIFIANT, NOM_COURT_SIT


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
[1] "Ozone"
[[1]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2011-01-01 UTC 2012-01-01 UTC         NA         NA     TRUE     NA   TRUE
  O3_2_VERDUN O3_VERDUN
1          NA      TRUE

[[2]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2011-01-01 UTC 2012-01-01 UTC         NA         NA       NA     NA      1
  O3_2_VERDUN O3_VERDUN
1          NA         1

[[3]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2009-01-01 UTC 2012-01-01 UTC         NA         NA       NA     NA      0
  O3_2_VERDUN O3_VERDUN
1          NA         0

[[4]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2007-01-01 UTC 2012-01-01 UTC         NA         NA       NA     NA     NA
  O3_2_VERDUN O3_VERDUN
1          NA        NA

[[5]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2011-01-01 UTC 2012-01-01 UTC          0          0        0      0      0
  O3_2_VERDUN O3_VERDUN
1           0         0

[[6]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2011-01-01 UTC 2012-01-01 UTC          0          0        0      0      0
  O3_2_VERDUN O3_VERDUN
1           0         0

[[7]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2011-01-01 UTC 2012-01-01 UTC          0          0        0      0      0
  O3_2_VERDUN O3_VERDUN
1           0         0

[[8]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2011-01-01 UTC 2012-01-01 UTC          0          0        0      0      0
  O3_2_VERDUN O3_VERDUN
1           0         0

[[9]]
           start            end O3_2_AYTRE O3_3_AYTRE O3_AYTRE O3_VA2 O3_VAU
1 2011-01-01 UTC 2012-01-01 UTC          0          0        0      0      0
  O3_2_VERDUN O3_VERDUN
1           0         0

Champs disponibles pour la recherche (mesures) : 
IDENTIFIANT, NOM_COURT_MES, NOM_MES, TYPE_MESURE, TYPE_ACQ, compCode, codeP2, D_CREATION, D_ARRET, DERNIER_QH, D_VALIDATION, D_VALIDATION_ENV, D_ADVAL, id_site, NSIT, NSIT_PUBLIC, NOM_COURT_SIT, UNITE, CCHIM, NOPOL

Par défaut : IDENTIFIANT, NOM_COURT_MES


Champs disponibles pour la recherche (stations) : 
IDENTIFIANT, NOM_COURT_SIT, NSIT, ISIT, D_CREATION, D_ARRET, NSIT_PUBLIC, ISIT_LONG, address.commune.labelCommune, NINSEE, LATI, LONGI, ALTI, AXE, CODE_POSTAL, LAMBERTX, LAMBERTY, address.departement.labelDepartement, address.departement.id, DENSITE, NBRE_SOURCES, NB_VEHICULE, RAYON_ACTION, ZONE_IMPLANT, DER_LECT_QH, CLASSE_SITE, SITE_TYPE, TYPE_LIEU_ECHAN, TYPE_VOIE, typologie, environment.locationTypeLabel, environment.samplingPlaceTypeLabel, environment.laneTypeLabel, TYPE_SECTEUR, ZONE_ACTIVITE, sectors.typeSectorLabel, sectors.zoneOfActivityLabel, campaigns

Par défaut : IDENTIFIANT, NOM_COURT_SIT


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
[1] "Dioxyde de soufre"
[[1]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC          NA      0         NA   NA

[[2]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC           0      0          0    0

[[3]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC           0      0          0    0

[[4]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC          NA  FALSE         NA   NA

[[5]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC          NA  FALSE         NA   NA

[[6]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC          NA      0         NA   NA

[[7]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2010-10-01 UTC 2012-04-01 UTC           0      0          0    0

[[8]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC          NA  FALSE         NA   NA

[[9]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2011-01-01 UTC 2012-01-01 UTC          NA  FALSE         NA   NA

[[10]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2010-10-01 UTC 2012-04-01 UTC           0      0          0    0

[[11]]
           start            end SO2_VAUGOIN S2_VAU SO2_VERDUN test
1 2010-10-01 UTC 2012-04-01 UTC           0      0          0    0

> 
> # le monoxyde de carbone CO
> #==========================
> 
> polluant <- '04'
> donnees <- xrGetContinuousData (xr, stations=stations, start='2004-01-01',
+ 				end='2005-01-01', polluants=polluant)
Champs disponibles pour la recherche (mesures) : 
IDENTIFIANT, NOM_COURT_MES, NOM_MES, TYPE_MESURE, TYPE_ACQ, compCode, codeP2, D_CREATION, D_ARRET, DERNIER_QH, D_VALIDATION, D_VALIDATION_ENV, D_ADVAL, id_site, NSIT, NSIT_PUBLIC, NOM_COURT_SIT, UNITE, CCHIM, NOPOL

Par défaut : IDENTIFIANT, NOM_COURT_MES


Champs disponibles pour la recherche (stations) : 
IDENTIFIANT, NOM_COURT_SIT, NSIT, ISIT, D_CREATION, D_ARRET, NSIT_PUBLIC, ISIT_LONG, address.commune.labelCommune, NINSEE, LATI, LONGI, ALTI, AXE, CODE_POSTAL, LAMBERTX, LAMBERTY, address.departement.labelDepartement, address.departement.id, DENSITE, NBRE_SOURCES, NB_VEHICULE, RAYON_ACTION, ZONE_IMPLANT, DER_LECT_QH, CLASSE_SITE, SITE_TYPE, TYPE_LIEU_ECHAN, TYPE_VOIE, typologie, environment.locationTypeLabel, environment.samplingPlaceTypeLabel, environment.laneTypeLabel, TYPE_SECTEUR, ZONE_ACTIVITE, sectors.typeSectorLabel, sectors.zoneOfActivityLabel, campaigns

Par défaut : IDENTIFIANT, NOM_COURT_SIT


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


> tmp <- validation.reglementaire (donnees, seuils(polluant=polluant),
+ 				 resultat='comparaison')
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
Simplified splitting algorithm
> tmp <- lapply (tmp, function(x)
+ 	       if (nrow(x) > 1) lapply (x, sum, na.rm=TRUE) else x)
> print (xrGetPolluants(xr, search.fields='NOPOL', polluant)$NCON)
[1] "Monoxyde de carbone"
> print(tmp)
[[1]]
           start            end CO_VAUGOUIN CO_A_VAUGOUIN CO_2_VERDUN CO_VERDUN
1 2004-01-01 UTC 2005-01-01 UTC          NA            NA          NA     FALSE

[[2]]
           start            end CO_VAUGOUIN CO_A_VAUGOUIN CO_2_VERDUN CO_VERDUN
1 2004-01-01 UTC 2005-01-01 UTC          NA            NA          NA     FALSE

[[3]]
           start            end CO_VAUGOUIN CO_A_VAUGOUIN CO_2_VERDUN CO_VERDUN
1 2004-01-01 UTC 2005-01-01 UTC          NA            NA          NA     FALSE

> 
> # les polluants manuels
> #======================
> 
> polluants <- c('19', 'V4', '80', '82', '87', 'P6')
> for (polluant in polluants)
+ {
+ 	donnees <- xrGetManualData (xr, start=debut, end=fin, sites=sites,
+ 					polluants=polluant)
+ 	tmp <- validation.reglementaire (donnees, seuils(polluant=polluant),
+ 					 etapes=c('preparation.comparaison',
+ 						  'comparaison'),
+ 					 resultat='detail',
+ 					 rep.b.comparaison = 0.1)
+ 	# on met 0.1 à la place de 0.14 parce que dans le cas présent
+ 	# on est entre 0.11 et 0.13
+ 
+ 	tmp <- lapply (tmp, function(x)
+ 		       if (nrow(x) > 1) lapply (x, sum, na.rm=TRUE) else x)
+ 
+ 	# affichage
+ 	print (xrGetPolluants(xr, search.fields='NOPOL', polluant)$NCON)
+ 	print (tmp)
+ }
Champs disponibles pour la recherche (sites de prélèvements) : 
NRESSURV, NSIT, IDSITEP, LIBELLE, LONGI, LATI, ALTI, NINSEE, AXE, COMMENTAIRE, NSIT_LOCAL, NOM_COURT_SIT_LOCAL, DATE_DEB, DATE_FIN, campaigns

Par défaut : IDSITEP, LIBELLE


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


[1] "Plomb"
[[1]]
           start            end D17LAR_STLOUIS.207.19
1 2011-01-01 UTC 2012-01-01 UTC                  9.82

[[2]]
           start            end D17LAR_STLOUIS.207.19
1 2011-01-01 UTC 2012-01-01 UTC                  9.82

[[3]]
           start            end D17LAR_STLOUIS.207.19
1 2011-01-01 UTC 2012-01-01 UTC                  9.82

[[4]]
           start            end D17LAR_STLOUIS.207.19
1 2011-01-01 UTC 2012-01-01 UTC                  9.82

Champs disponibles pour la recherche (sites de prélèvements) : 
NRESSURV, NSIT, IDSITEP, LIBELLE, LONGI, LATI, ALTI, NINSEE, AXE, COMMENTAIRE, NSIT_LOCAL, NOM_COURT_SIT_LOCAL, DATE_DEB, DATE_FIN, campaigns

Par défaut : IDSITEP, LIBELLE


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


[1] "Benzene"
[[1]]
           start            end D17LAR_STLOUIS.215.V4
1 2011-01-01 UTC 2012-01-01 UTC                   1.7

[[2]]
           start            end D17LAR_STLOUIS.215.V4
1 2011-01-01 UTC 2012-01-01 UTC                   1.7

[[3]]
           start            end D17LAR_STLOUIS.215.V4
1 2011-01-01 UTC 2012-01-01 UTC                   1.7

[[4]]
           start            end D17LAR_STLOUIS.215.V4
1 2011-01-01 UTC 2012-01-01 UTC                   1.7

Champs disponibles pour la recherche (sites de prélèvements) : 
NRESSURV, NSIT, IDSITEP, LIBELLE, LONGI, LATI, ALTI, NINSEE, AXE, COMMENTAIRE, NSIT_LOCAL, NOM_COURT_SIT_LOCAL, DATE_DEB, DATE_FIN, campaigns

Par défaut : IDSITEP, LIBELLE


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


[1] "Arsenic particulaire"
[[1]]
           start            end D17LAR_STLOUIS.207.80
1 2011-01-01 UTC 2012-01-01 UTC                  0.81

[[2]]
           start            end D17LAR_STLOUIS.207.80
1 2011-01-01 UTC 2012-01-01 UTC                  0.81

[[3]]
           start            end D17LAR_STLOUIS.207.80
1 2011-01-01 UTC 2012-01-01 UTC                  0.81

Champs disponibles pour la recherche (sites de prélèvements) : 
NRESSURV, NSIT, IDSITEP, LIBELLE, LONGI, LATI, ALTI, NINSEE, AXE, COMMENTAIRE, NSIT_LOCAL, NOM_COURT_SIT_LOCAL, DATE_DEB, DATE_FIN, campaigns

Par défaut : IDSITEP, LIBELLE


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


[1] "Cadmium particulaire"
[[1]]
           start            end D17LAR_STLOUIS.207.82
1 2011-01-01 UTC 2012-01-01 UTC                  0.08

[[2]]
           start            end D17LAR_STLOUIS.207.82
1 2011-01-01 UTC 2012-01-01 UTC                  0.08

[[3]]
           start            end D17LAR_STLOUIS.207.82
1 2011-01-01 UTC 2012-01-01 UTC                  0.08

Champs disponibles pour la recherche (sites de prélèvements) : 
NRESSURV, NSIT, IDSITEP, LIBELLE, LONGI, LATI, ALTI, NINSEE, AXE, COMMENTAIRE, NSIT_LOCAL, NOM_COURT_SIT_LOCAL, DATE_DEB, DATE_FIN, campaigns

Par défaut : IDSITEP, LIBELLE


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


[1] "Nickel particulaire"
[[1]]
           start            end D17LAR_STLOUIS.207.87
1 2011-01-01 UTC 2012-01-01 UTC                  1.29

[[2]]
           start            end D17LAR_STLOUIS.207.87
1 2011-01-01 UTC 2012-01-01 UTC                  1.29

[[3]]
           start            end D17LAR_STLOUIS.207.87
1 2011-01-01 UTC 2012-01-01 UTC                  1.29

Champs disponibles pour la recherche (sites de prélèvements) : 
NRESSURV, NSIT, IDSITEP, LIBELLE, LONGI, LATI, ALTI, NINSEE, AXE, COMMENTAIRE, NSIT_LOCAL, NOM_COURT_SIT_LOCAL, DATE_DEB, DATE_FIN, campaigns

Par défaut : IDSITEP, LIBELLE


Champs disponibles pour la recherche (polluants) : 
NOPOL, CCHIM, NCON

Par défaut : NOPOL, CCHIM, NCON


[1] "Benzo(a)pyrène particulaire PM10"
[[1]]
           start            end D17LAR_STLOUIS.207.P6
1 2011-01-01 UTC 2012-01-01 UTC                   0.2

[[2]]
           start            end D17LAR_STLOUIS.207.P6
1 2011-01-01 UTC 2012-01-01 UTC                   0.2

[[3]]
           start            end D17LAR_STLOUIS.207.P6
1 2011-01-01 UTC 2012-01-01 UTC                   0.2

> 
> # On ferme
> #=========
> 
> xrDisconnect(xr)
Déconnexion réussie. L'API reste consultable sur sa partie publique (si activée).
$host
[1] "xair.atmo-na.org"

$port
[1] 8443

$version
[1] 2

$logged
[1] FALSE

attr(,"class")
[1] "xr"
> 
> proc.time()
   user  system elapsed 
 39.454   0.401  55.599 
